<div class="customer-detail-container">
  <div *ngIf="loading" class="flex justify-content-center align-items-center" style="min-height: 400px">
    <p-progressSpinner></p-progressSpinner>
  </div>

  <div *ngIf="!loading && customer">
    <!-- Header Card -->
    <div class="header-card">
      <div class="flex align-items-center gap-3">
        <button pButton
          icon="pi pi-arrow-left"
          class="p-button-soft p-button-primary p-button-rounded"
          (click)="goBack()"
          pTooltip="Quay lại"
          tooltipPosition="bottom">
        </button>
        <p-avatar 
          [label]="getInitials(customer.contactPerson || customer.name)"
          [style]="{'background-color': getAvatarColor(customer.contactPerson || customer.name), 'color': '#ffffff'}"
          shape="circle" 
          styleClass="customer-avatar">
        </p-avatar>
        <div class="flex-1">
          <div class="flex align-items-center gap-2">
            <h2 class="customer-name m-0">
              {{ customer.name }}
            </h2>
          </div>
        </div>
      </div>
    </div>

    <!-- Customer Information -->
    <div class="content-card">
      <p-tabView [(activeIndex)]="activeTabIndex">
      <!-- Tab 1: Danh sách PO -->
      <p-tabPanel header="Danh sách PO" leftIcon="pi pi-receipt">
        <app-po-list 
          [customerId]="customerId || undefined" 
          [hideHeader]="true">
        </app-po-list>
      </p-tabPanel>

      <!-- Tab 2: Nguyên vật liệu kho -->
      <p-tabPanel header="Nguyên vật liệu kho" leftIcon="pi pi-box">
        <app-customer-materials-list [customerId]="customerId || undefined"></app-customer-materials-list>
      </p-tabPanel>

      <!-- Tab 3: Kiểm tra tính khả dụng linh kiện -->
      <p-tabPanel header="Kiểm tra tính khả dụng linh kiện" leftIcon="pi pi-check-circle">
        <app-availability-check [customerId]="customerId || undefined"></app-availability-check>
      </p-tabPanel>
      </p-tabView>
    </div>
  </div>
</div>

<p-toast></p-toast>

